import pickle as pkl
import matplotlib.pyplot as plt
import numpy as np


arr = pkl.load(open('Results/HiFi-GAN/Stats/Training/all_losses.pkl', 'rb'))
'''avg_spec_loss = [x['avg_spec_loss'] for x in arr]
avg_vld_loss = [x['avg_valid_loss'] for x in arr]

avg_spec_loss = [21.9599, 18.6597, 17.211 , 16.5605, 16.0585, 15.6663, 15.193 ,
       15.0907, 14.8363, 14.3947, 14.3066, 14.1466, 14.0033, 13.5595,
       13.5975, 13.4014, 13.1541, 13.0154, 12.8544, 12.6434, 12.531 ,
       12.4029, 12.1844, 12.227 , 12.0894, 11.8713, 11.8822, 11.6399,
       11.466 , 11.3749, 11.3977, 11.2702, 11.2653, 11.0495, 10.9705,
       10.932 , 10.932 , 10.8259, 10.8259, 10.662 , 10.6397, 10.6025,
       10.4201, 10.5195, 10.3579, 10.2673, 10.1731, 10.1027, 10.0975,
       10.0089,  9.8644,  9.8632,  9.7583,  9.6809,  9.6864,  9.5656,
        9.5848,  9.4955,  9.4837,  9.4176,  9.3217,  9.2649,  9.2696,
        9.1863,  9.2052,  9.0714,  9.1276,  8.9768,  8.9476,  8.9098,
        8.8366,  8.9045,  8.8181,  8.8424,  8.7338,  8.6969,  8.66  ,
        8.6231,  8.5862,  8.5493,  8.5124,  8.4755,  8.4386,  8.4017,
        8.3648,  8.3279,  8.291 ,  8.2541,  8.2172,  8.1803,  8.1434,
        8.1065,  8.0696,  8.0327,  7.9958,  7.9589,  7.922 ,  7.8851,
        7.8482,  7.8113]

avg_vld_loss = [19.4755, 19.4874, 18.8718, 19.5378, 19.5818, 19.6443, 20.057, 20.2145,
20.452, 20.7864, 21.392, 20.3104, 20.2563, 19.7322, 20.6061, 20.0981,
20.3663, 20.5612, 20.8596, 20.3234, 20.0495, 20.1909, 20.3334, 20.0576,
19.8572, 20.7075, 20.5729, 20.4263, 20.4519, 20.3193, 20.5128, 20.4409,
20.2861, 20.2789, 20.1263, 20.0184, 19.9958, 19.8609, 19.8546, 19.7942,
19.7643, 19.7482, 19.6664, 19.6352, 19.5703, 19.5529, 19.5152, 19.4317,
19.4103, 19.3958, 19.3503, 19.3212, 19.2517, 19.1994, 19.1247, 19.0532,
19.0234, 18.9468, 18.9243, 18.8821, 18.7967, 18.7863, 18.7863, 18.7681,
18.7498, 18.7316, 18.7133, 18.6951, 18.6768, 18.6586, 18.6404, 18.6221,
18.6039, 18.5856, 18.5674, 18.5491, 18.5309, 18.5127, 18.4944, 18.4762,
18.4579, 18.4397, 18.4214, 18.4032, 18.3849, 18.3667, 18.3485, 18.3302,
18.312, 18.2937, 18.2755, 18.2572, 18.239, 18.2208, 18.2025, 18.1843,
18.166, 18.1478, 18.1295, 18.1145]

plt.plot(np.arange(len(avg_spec_loss)), avg_spec_loss, label='Average Generator Spectral Loss')
plt.plot(np.arange(len(avg_vld_loss)), avg_vld_loss, label='Average Validation Loss')'''
plt.plot(np.arange(len(arr)), [x['avg_msd_loss'] for x in arr], label='Average MSD Loss')
plt.plot(np.arange(len(arr)), [x['avg_mpd_loss'] for x in arr], label='Average MPD Loss')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.legend()
plt.show()